<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Password Setting</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(-45deg, #0f172a, #1e293b, #3b0764, #111827);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
    }
    @keyframes gradientBG {
      0% {background-position: 0% 50%}
      50% {background-position: 100% 50%}
      100% {background-position: 0% 50%}
    }
  </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4 text-white relative">

  <!-- Back to Profile Button -->
  <a href="profile.html" class="absolute top-4 left-4 px-3 py-2 rounded-md text-white font-medium bg-white/10 backdrop-blur-sm border border-white/10 hover:bg-white/20 text-sm">
    ← Back
  </a>

  <!-- Password Form -->
  <div class="w-full max-w-xs glass rounded-xl bg-white/5 backdrop-blur-lg p-6">
    <h2 class="text-lg font-semibold mb-4 text-center">Change Password</h2>
    <input type="password" id="oldPwd" placeholder="Old password" required
           class="w-full p-3 mb-3 rounded-lg bg-gray-800 text-white text-sm outline-none" />
    <input type="password" id="newPwd" placeholder="New password" required
           class="w-full p-3 mb-3 rounded-lg bg-gray-800 text-white text-sm outline-none" />
    <input type="password" id="confirmPwd" placeholder="Confirm new password" required
           class="w-full p-3 mb-4 rounded-lg bg-gray-800 text-white text-sm outline-none" />
    <button id="submitBtn" class="w-full p-3 bg-green-500 hover:bg-green-400 text-black font-semibold rounded-lg transition">Submit</button>
    <p id="msg" class="mt-3 text-sm text-center"></p>
  </div>

  <script>
    // Initialize dummy account if not exist
    if (!localStorage.getItem("username")) {
      localStorage.setItem("username", "admin");
      localStorage.setItem("password", "123456");
    }

    const oldInput = document.getElementById("oldPwd");
    const newInput = document.getElementById("newPwd");
    const confInput = document.getElementById("confirmPwd");
    const msg = document.getElementById("msg");

    document.getElementById("submitBtn").onclick = () => {
      const storedPwd = localStorage.getItem("password");
      const oldVal = oldInput.value.trim();
      const newVal = newInput.value.trim();
      const confVal = confInput.value.trim();

      if (oldVal !== storedPwd) {
        msg.textContent = "❌ Old password is incorrect.";
        msg.style.color = "#f87171";
        return;
      }

      if (newVal.length < 4) {
        msg.textContent = "⚠️ New password must be at least 4 characters.";
        msg.style.color = "#facc15";
        return;
      }

      if (newVal !== confVal) {
        msg.textContent = "⚠️ Password confirmation doesn't match.";
        msg.style.color = "#facc15";
        return;
      }

      // Save the new password
      localStorage.setItem("password", newVal);
      msg.textContent = "✅ Password changed successfully! Redirecting...";
      msg.style.color = "#4ade80";

      setTimeout(() => {
        window.location.href = "profile.html";
      }, 1500);
    };
  </script>
</body>
</html>
