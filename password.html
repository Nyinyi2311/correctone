<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF‑8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Password Setting</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(-45deg, #0f172a, #1e293b, #3b0764, #111827);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      color: white;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      position: relative;
    }
    @keyframes gradientBG {
      0% {background-position: 0% 50%}
      50% {background-position: 100% 50%}
      100% {background-position: 0% 50%}
    }
    .glass {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(12px);
      padding: 2rem;
      border-radius: 1rem;
      width: 100%;
      max-width: 400px;
      z-index: 10;
    }
    input {
      width: 100%;
      padding: 0.75rem;
      margin-bottom: 1rem;
      border: none;
      border-radius: 0.5rem;
      background: #333;
      color: #fff;
    }
    button {
      width: 100%;
      padding: 0.75rem;
      background: #22c55e;
      border: none;
      color: #000;
      font-weight: bold;
      border-radius: 0.5rem;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <!-- Back to Profile Button -->
  <a href="profile.html" class="absolute top-4 left-4 px-4 py-2 rounded-md text-white font-semibold bg-white/10 backdrop-blur-sm border border-white/10 hover:bg-white/20 transition">
    ← Back to Profile
  </a>

  <!-- Password Form -->
  <div class="glass">
    <h2 class="text-xl font-bold mb-4 text-center">Change Password</h2>
    <input type="password" id="oldPwd" placeholder="Please enter your old password" required />
    <input type="password" id="newPwd" placeholder="Please enter your new password" required />
    <input type="password" id="confirmPwd" placeholder="Please enter your new password again" required />
    <button id="submitBtn">Submit</button>
    <p id="msg" class="mt-2 text-sm text-center"></p>
  </div>

  <script>
    // Initialize dummy account if not exist
    if (!localStorage.getItem("username")) {
      localStorage.setItem("username", "admin");
      localStorage.setItem("password", "123456");
    }

    const oldInput = document.getElementById("oldPwd");
    const newInput = document.getElementById("newPwd");
    const confInput = document.getElementById("confirmPwd");
    const msg = document.getElementById("msg");

    document.getElementById("submitBtn").onclick = () => {
      const storedPwd = localStorage.getItem("password");
      const oldVal = oldInput.value.trim();
      const newVal = newInput.value.trim();
      const confVal = confInput.value.trim();

      if (oldVal !== storedPwd) {
        msg.textContent = "❌ Old password is incorrect.";
        msg.style.color = "#f87171";
        return;
      }

      if (newVal.length < 4) {
        msg.textContent = "⚠️ New password must be at least 4 characters.";
        msg.style.color = "#facc15";
        return;
      }

      if (newVal !== confVal) {
        msg.textContent = "⚠️ Password confirmation doesn't match.";
        msg.style.color = "#facc15";
        return;
      }

      // Save the new password
      localStorage.setItem("password", newVal);
      msg.textContent = "✅ Password changed successfully! Redirecting...";
      msg.style.color = "#4ade80";

      setTimeout(() => {
        window.location.href = "profile.html";
      }, 1500);
    };
  </script>
</body>
</html>
